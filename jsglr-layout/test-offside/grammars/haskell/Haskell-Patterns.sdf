module Haskell-Patterns
exports
  context-free syntax
    LPat -> Pat
    
  context-free priorities
      Pat Qconop LPat -> Pat {cons("BinOpApp")}
    > XPat ConsOp Pat -> Pat {cons("BinOpApp")}
    
  context-free syntax
  	Pat Qconop LPat -> XPat {cons("BinOpApp")}
  	LPat -> XPat
  	
    APat -> LPat
    "-" Literal -> LPat {cons("Negation")}
    Gcon APat+ -> LPat {cons("ConstrApp")}
    
    Var -> APat
    Var "@" APat -> APat {cons("Named")}
    Gcon -> APat {cons("Constr")}
    Qcon LabeledPat -> APat {cons("Labeled")}
    "{" {FPat ","}* "}" -> LabeledPat {cons("Labeled"), ignore-indent}
    Literal -> APat
    "_" -> APat {cons("Wildcard")}
    "(" Pat ")" -> APat {bracket}
    "(" Pat "," {Pat ","}+ ")" -> APat {cons("Tuple")}
    "[" {Pat ","}+ "]" -> APat {cons("List")}
    "~" APat -> APat {cons("Irrefutable")}
    
    Qvar "=" Pat -> FPat {cons("PatBind")}
    