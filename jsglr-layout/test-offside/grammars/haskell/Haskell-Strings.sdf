module Haskell-Strings
exports
  syntax
    "'" CharChar "'"                        -> <Char-CF>   {cons("Char")}
    "\"" StringChar* "\""                   -> <String-CF> {cons("String")}
    <CharChar-LEX>                          -> CharChar    
    "\\" Escape                             -> CharChar    {cons("Escape")}
    "\\" ( [\38] )                          -> CharChar    {reject}
    <StringChar-LEX>                        -> StringChar  
    "\\" Escape                             -> StringChar  {cons("Escape")}
    "\\" ( [\9-\10] | [\13] | [\32] )+ "\\" -> StringChar  {cons("Gap")}
    <CharEsc-LEX>                           -> Escape      {cons("CharEsc")}
    <ASCII-LEX>                             -> Escape      {cons("ASCIIEsc")}
    <Decimal-LEX>                           -> Escape      {cons("DecimalEsc")}
    "o" <Octal-LEX>                         -> Escape      {cons("OctalEsc")}
    "x" <Hexadecimal-LEX>                   -> Escape      {cons("HexadecimalEsc")}

  lexical syntax
    ( [\32-\38] | [\40-\91] | [\93-\127] | ( [\7] ( [\0] [\128-\255] ) | ( [\1-\254] [\0-\255] ) | ( [\255] [\0-\255] ) ) | ( [\7] ( [\216-\220] [\0-\255] [\220-\255] [\0-\255] ) | ( [\219-\223] [\0-\255] [\0-\223] [\0-\253] ) | ( [\221-\222] [\0-\255] [\0-\255] [\0-\255] ) ) ) -> CharChar   
    ( [\32-\33] | [\35-\91] | [\93-\127] | ( [\7] ( [\0] [\128-\255] ) | ( [\1-\254] [\0-\255] ) | ( [\255] [\0-\255] ) ) | ( [\7] ( [\216-\220] [\0-\255] [\220-\255] [\0-\255] ) | ( [\219-\223] [\0-\255] [\0-\223] [\0-\253] ) | ( [\221-\222] [\0-\255] [\0-\255] [\0-\255] ) ) ) -> StringChar 
    ( [\34] | [\38-\39] | [\92] | [\97-\98] | [\102] | [\110] | [\114] | [\116] | [\118] )                                                                                                                                                                                             -> CharEsc    
    "^" ( [\64-\95] )                                                                                                                                                                                                                                                                  -> ASCII      
    "NUL" | "SOH" | "STX" | "ETX" | "EOT" | "ENQ" | "ACK" | "BEL" | "BS" | "HT" | "LF" | "VT" | "FF" | "CR" | ASCII-SO | "SI" | "DLE" | "DC1" | "DC2" | "DC3" | "DC4" | "NAK" | "SYN" | "ETB" | "CAN" | "EM" | "SUB" | "ESC" | "FS" | "GS" | "RS" | "US" | "SP" | "DEL"                -> ASCII      
    "SO"                                                                                                                                                                                                                                                                               -> ASCII-SO   

  lexical restrictions
    ASCII-SO -/- [\72]