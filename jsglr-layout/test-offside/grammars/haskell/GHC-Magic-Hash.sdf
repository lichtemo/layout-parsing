module GHC-Magic-Hash
imports Haskell-Identifiers
imports Haskell-Numbers
imports Haskell-Strings
exports
  lexical syntax
  	[a-z][A-Za-z0-9\'\_]*[\#]+ -> VARID
    [\_][A-Za-z0-9\'\_]+[\#]+  -> VARID
    [A-Z][A-Za-z0-9\'\_]*[\#]+ -> CONID
  
  lexical restrictions
  	VARID -/- [\#]
  	CONID -/- [\#]

  lexical syntax
    Decimal "#"              -> INTEGER-HASH
    [0] [Oo] Octal "#"       -> INTEGER-HASH
    [0] [Xx] Hexadecimal "#" -> INTEGER-HASH
    
    Decimal "." Decimal "#"          -> FLOAT-HASH
    Decimal Exponent "#"             -> RATIONAL-HASH
    Decimal "." Decimal Exponent "#" -> RATIONAL-HASH

  syntax
    "'" CharChar "'" "#"       -> <Char-HASH-CF> {cons("Char")}
    "\"" StringChar* "\"" "#"  -> <String-HASH-CF> {cons("String")}
    
  context-free syntax
    INTEGER-HASH  -> Literal {cons("Int")}
    FLOAT-HASH    -> Literal {cons("Float")}
    RATIONAL-HASH -> Literal {cons("Float")}
    
    Char-HASH   -> Literal
    String-HASH -> Literal

  lexical restrictions
    INTEGER -/- [\#]
    FLOAT -/- [\#]
    RATIONAL -/- [\#]
    
  context-free restrictions
    Char -/- [\#]
    String -/- [\#]
