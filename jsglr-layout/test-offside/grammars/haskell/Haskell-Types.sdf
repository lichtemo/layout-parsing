module Haskell-Types

imports Haskell-Identifier-Sorts
		Haskell-Operators

exports
  context-free syntax
	ProportionOp Type		-> OptSigH {ast("<2>")}
	OptSigH?				-> OptSig 

  context-free syntax
    Qtycon 	   	   -> Gtycon
    "(" RightArrowOp ")"           -> Gtycon 	{ast("TArrow")}

  context-free syntax
    {Type ","}+ 	   -> Types
    Type "," {Type ","}+   -> Types2 	{cons("Cons")}
    
    %% CType is a forall type, the explicit forall is defined in the forall extension 
    Type -> CType
    Context Type -> CType {cons("ImplicitForall")}
    
  context-free syntax
    Gtycon 		   -> AType 	{cons("TCon")}
    Tyvar 		   -> AType 	{cons("TVar")}
    "(" CType ")" 	   -> AType 	{bracket}
    "[" Type "]" 	   -> AType 	{cons("TList")}
    "(" Types2 ")" 	   -> AType 	{cons("TProd")}

    AType -> Type
    Type Type 	   	   		-> Type 	{cons("TAppBin"),left}
    Type RightArrowOp Type 	-> Type 	{ast("TFunBin(<1>,<3>)"),right}

  context-free priorities
    Type Type 	   	   -> Type 
  > Type RightArrowOp Type 	   -> Type

  %% The following productions are syntactic sugar for
  %% [] Type and (,,,) Type ... Type

  context-free syntax
    "(" ")" 	           -> Gtycon 	{cons("TUnit")}
    "[" "]"                -> Gtycon 	{cons("TList")}
    "(" ","+ ")"           -> Gtycon 	{cons("TProduct")}

